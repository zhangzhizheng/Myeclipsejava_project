<%@ page language="java" contentType="text/html;charset=gbk" import="java.util.*"%>
<%@ page import="java.sql.*"%>
<%@ page import="java.util.*"%>
<html>
<head>
<title>影迷互动平台</title>
		<link rel=stylesheet type=text/css href="../lib/movie.css">

		<jsp:useBean scope="page" id="News" class="com.cyl.impl.News" />
		<jsp:useBean scope="page" id="Page" class="com.cyl.impl.SplitPage" />

</head>
<body background="images/0008d-background.jpg"> 
<%@include file="../inc/admin_head.inc"%>
	<div align="center"><br>
	<form name="form1" action="delete_news.jsp" method="post" target="_self">
	
	<table width="90%" border="1" cellpadding="0" cellspacing="0">

				<tr bgcolor="#aad3e4">
	
					<th height="25" align="center" width="10%">选择</th>
					<th height="25" align="center" width="30%">标题</th>
					
					<th height="25" align="center" width="22%">时间</th>
					
					<th height="25" align="center" width="10%">操作</th>
					</tr>

	<%
		ResultSet rs = News.show_all_news();		
		//初始化分页显示类，每页显示10条记录
			Page.initialize(rs,10);
			//获取当前所要显示的页数
			String strPage=null;
			int showPage = 1;
			//获取跳转到的目的页面
			strPage=request.getParameter("showPage");	
			if (strPage==null)
				showPage=1;
			else
			{
				try
				{
					showPage=Integer.parseInt(strPage);
				}
				catch(NumberFormatException e)
				{
					showPage = 1;
				}
				if(showPage<1) 
					showPage=1;
		
				if(showPage>Page.getPageCount()) 
					showPage=Page.getPageCount();
			}
			
			//获取要显示的数据集合
			Vector vData=Page.getPage(showPage);	
						int i = 0 ;
			for(i=0;i<vData.size();i++)
			{
			String[] sData=(String[])vData.get(i);
			//String temp=sData[3].substring(0,19);
			long l = Long.parseLong(sData[0]);
			//System.out.println(l);
	%>
	
				<tr>
					<td height="25" align="center"><input type="checkbox" name="DeleteID" value="<%=sData[0]%>"></td>
					<td height="25" align="left">&nbsp;<a href="./news_detail.jsp?NewsID=<%=sData[0]%>" target="_self"><font color="#0000FF"><%=sData[1]%></font></a></td>
					 
					<td height="25" align="left">&nbsp;<%=sData[4]%></td>
					<td height="25" align="center"><a href="./modify_news_form.jsp?NewsID=<%=sData[0]%>&showPage=<%=showPage%>" target="_self"><font color="#0000FF">修改</font></a></td>
					</tr>
	<%
		}
	%>
	</table>
	<input type="hidden" name="showPage" value="<%=showPage%>">
	<p><input type="submit" name="sub" value="删除选中的新闻">
		<input type="button" name="btn" value="增加新闻" onClick="javascript:window.location='add_news_form.jsp'">
	</p>
	</form>
	<p>
		第<font color="#FF0000"><%=showPage%></font>页/共<font color=red><%=Page.getPageCount()%></font>页&nbsp;
		<a href="news_management.jsp?showPage=1" target="_self"><font color="#0000FF">[首页]</font></a>&nbsp;			
		<%
			//判断"上一页"链接是否要显示
			if(showPage > 1){
		%>
				<a href="news_management.jsp?showPage=<%=showPage-1%>" target="_self"><font color="#0000FF">[上一页]</font> </a>&nbsp;
		<%
			}else
				out.println("[上一页]&nbsp;");

			//判断"下一页"链接是否要显示
			if(showPage < Page.getPageCount())
			{				
		%>
				<a href="news_management.jsp?showPage=<%=showPage+1%>" target="_self"><font color="#0000FF">[下一页]</font> </a>&nbsp;
		<%
			}
			else
				out.println("[下一页]&nbsp;");

		%> 
		<a href="news_management.jsp?showPage=<%=Page.getPageCount()%>" target="_self"><font color="#0000FF">[尾页]</font> </a>&nbsp;
		</p>
		
	<%rs.close();%>
</div>
</body>
<%@include file="../inc/tail.inc"%>
</html>
